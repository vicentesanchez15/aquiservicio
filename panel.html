<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Panel • Aquiservicio</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --navy:#0b1220; --navy2:#0f1a33;
      --txt:#0f172a; --card:rgba(255,255,255,.94);
      --shadow:0 20px 70px rgba(2,6,23,.18);
      --r:20px;
      --green:#16a34a; --greenBg:rgba(34,197,94,.12); --greenBd:rgba(34,197,94,.28);
      --glow:rgba(56,189,248,.22);
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;color:var(--txt);
      background:
        radial-gradient(900px 600px at 10% 0%, rgba(56,189,248,.14), transparent 60%),
        radial-gradient(900px 600px at 90% 10%, rgba(99,102,241,.12), transparent 55%),
        linear-gradient(180deg, var(--navy), var(--navy2));
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:18px;
    }
    .shell{width:min(760px,100%)}
    .card{
      background:var(--card);border:1px solid rgba(255,255,255,.18);box-shadow:var(--shadow);
      border-radius: calc(var(--r) + 10px);overflow:hidden;backdrop-filter: blur(10px);
      animation: in .35s ease-out;
    }
    @keyframes in{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .main{padding:16px 14px 18px}
    .top{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .btn{
      border:1px solid rgba(15,23,42,.10);background:#fff;border-radius:999px;
      padding:10px 12px;font-weight:900;cursor:pointer;
    }
    .h{
      margin:12px 0 6px;font-weight:900;font-size:20px;
      background: linear-gradient(90deg, rgba(56,189,248,.9), rgba(99,102,241,.9));
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .box{
      background:#fff;border:1px solid rgba(15,23,42,.10);border-radius:18px;padding:12px;
      box-shadow: 0 10px 24px rgba(2,6,23,.06);
    }
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      font-weight:900;font-size:12px;border-radius:999px;padding:6px 10px;
      border:1px solid rgba(15,23,42,.10);background:rgba(2,6,23,.03);color:rgba(15,23,42,.75);
    }
    .badge.ok{border-color:var(--greenBd);background:var(--greenBg);color:var(--green);}
    .row{margin-top:8px;color:rgba(15,23,42,.78);font-weight:800;line-height:1.55}
    .row b{color:rgba(15,23,42,.98)}
    .msg{margin-top:10px;font-weight:900;color:rgba(15,23,42,.70)}
  </style>
</head>
<body>
  <div class="shell">
    <div class="card">
      <div class="main">
        <div class="top">
          <a class="btn" href="index.html">← Inicio</a>
          <img src="assets/logo.svg" alt="aquiservicio.com" style="height:24px;transform:translateX(-6px)">
          <button class="btn" id="logout">Salir</button>
        </div>

        <h1 class="h">Tu panel</h1>

        <div class="box" id="box">Cargando…</div>
        <div class="msg" id="msg"></div>
      </div>
    </div>
  </div>

  <script>
    const $ = (id)=>document.getElementById(id);

    function esc(s){
      return String(s||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;");
    }

    async function load(){
      const r = await fetch("/api/me");
      const out = await r.json().catch(()=>({}));
      if(!r.ok || out.error){
        $("box").innerHTML = "No has iniciado sesión.";
        $("msg").textContent = "Ve a iniciar sesión primero.";
        return;
      }
      const b = out.data;

      $("box").innerHTML = `
        <div style="display:flex;justify-content:space-between;gap:10px;align-items:flex-start">
          <div>
            <div style="font-weight:900;font-size:16px">${esc(b.name)}</div>
            <div style="font-weight:850;color:rgba(15,23,42,.75);margin-top:4px">${esc(b.category_primary)} • ${esc(b.municipality)} • ${esc(b.locality)}</div>
          </div>
          <span class="badge ${b.verified ? "ok":""}">${b.verified ? "Verificado" : "Sin verificar"}</span>
        </div>

        <div class="row" style="margin-top:10px"><b>WhatsApp:</b> ${esc(b.whatsapp)}</div>
        ${b.phone ? `<div class="row"><b>Tel:</b> ${esc(b.phone)}</div>` : ``}
        ${b.description ? `<div class="row"><b>Descripción:</b> ${esc(b.description)}</div>` : ``}
        <div class="row"><b>Modalidad:</b>
          ${(b.delivery ? "Domicilio " : "")}
          ${(b.pickup ? "• Ordena y recoge " : "")}
          ${(b.dine_in ? "• Sucursal" : "")}
          ${(!b.delivery && !b.pickup && !b.dine_in) ? "-" : ""}
        </div>
      `;

      $("msg").textContent = "Próximo: aquí activamos edición de perfil, horarios, fotos y promociones por plan.";
    }

    $("logout").addEventListener("click", async ()=>{
      await fetch("/api/logout");
      location.href = "/index.html";
    });

    load();
  </script>
</body>
</html>
