<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aquiservicio</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;800;900&family=Poppins:wght@700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --navy:#0b1220;
      --navy2:#0f1a33;
      --txt:#0f172a;
      --mut:#64748b;

      --card:rgba(255,255,255,.94);
      --glow:rgba(56,189,248,.22);
      --shadow:0 20px 70px rgba(2,6,23,.18);
      --r:20px;

      --welcomeBlue:#0f2f6b; /* azul medianoche real */
      --pillText:#0f172a;
      --pillBg:rgba(56,189,248,.16);
      --pillBd:rgba(56,189,248,.28);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--txt);
      background:
        radial-gradient(900px 600px at 10% 0%, rgba(56,189,248,.14), transparent 60%),
        radial-gradient(900px 600px at 90% 10%, rgba(99,102,241,.12), transparent 55%),
        linear-gradient(180deg, var(--navy), var(--navy2));
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }

    .shell{width:min(980px, 100%);}
    .card{
      background: var(--card);
      border:1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      border-radius: calc(var(--r) + 10px);
      overflow:hidden;
      backdrop-filter: blur(10px);
      animation: in .35s ease-out;
    }
    @keyframes in{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

    .main{padding:18px 12px 20px}

    .hero{
      text-align:center;
      padding:6px 8px 10px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
    }

    /* Logo centrado, apenas a la izquierda */
    .wordmark{
      width: min(450px, 86vw);
      height:auto;
      display:block;
      margin: 0 auto;
      transform: translateX(-12px);
      filter: drop-shadow(0 16px 40px rgba(2,6,23,.14));
    }

    /* Selector */
    .municipalityBox{
      width:100%;
      max-width:560px;
      margin:0 auto;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
      position:relative;
    }
    .municipalityBox label{
      font-size:13px;
      font-weight:900;
      letter-spacing:.10em;
      text-transform:uppercase;
      color: rgba(15,23,42,.72);
    }
    .municipalityBox::after{
      content:"‚ñæ";
      position:absolute;
      right:16px;
      bottom:14px;
      font-size:16px;
      font-weight:900;
      color: rgba(15,23,42,.60);
      pointer-events:none;
    }

    select{
      width:100%;
      appearance:none;
      -webkit-appearance:none;
      -moz-appearance:none;
      padding:14px 44px 14px 14px;
      font-size:16px;
      font-weight:900;
      border-radius:18px;
      border:1px solid rgba(15,23,42,.16);
      background: linear-gradient(180deg, rgba(15,23,42,.10), rgba(15,23,42,.06)); /* m√°s oscuro/pro */
      color: rgba(15,23,42,.95);
      box-shadow: 0 10px 28px rgba(2,6,23,.10);
      outline:none;
      cursor:pointer;
      max-width:560px;
    }
    select:focus{
      box-shadow:0 0 0 4px var(--glow), 0 10px 28px rgba(2,6,23,.12);
      border-color: rgba(56,189,248,.45);
    }

    /* BIENVENIDOS animado (esto reemplaza ‚Äúmuchas gracias‚Äù) */
    .welcomePill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:15px;
      font-weight:900;
      letter-spacing:.22px;
      color: var(--pillText);
      background: var(--pillBg);
      border:1px solid var(--pillBd);
      padding:10px 12px;
      border-radius:999px;
      backdrop-filter: blur(8px);
      user-select:none;
      white-space:nowrap;
      animation: floaty 2.2s ease-in-out infinite;
    }
    @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(-7px)}}

    /* T√≠tulo grande (antes era welcome) */
    .welcomeTitle{
      margin:0;
      font-family:Poppins, Inter, system-ui, Arial;
      font-weight:900;
      letter-spacing: .18em;
      font-size: 22px;
      color: var(--welcomeBlue);
      text-transform: uppercase;
      line-height:1.1;
    }

    .subtitle{
      margin:0;
      color: rgba(15,23,42,.72);
      font-size:14.5px;
      line-height:1.45;
      font-weight:650;
      max-width: 820px;
    }

    /* Botones grandes */
    .btnGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
      margin-top:16px;
      justify-items:center;
    }
    @media (min-width:720px){ .btnGrid{grid-template-columns:1fr 1fr 1fr;} }

    .bigBtn{
      width:100%;
      max-width:520px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      padding:16px 16px;
      border-radius:22px;
      border:1px solid rgba(15,23,42,.10);
      text-decoration:none;
      color:var(--txt);
      background: #fff;
      box-shadow: 0 14px 40px rgba(2,6,23,.10);
      transition: transform .12s ease, box-shadow .12s ease;
      user-select:none;
    }
    .bigBtn:hover{transform:translateY(-1px); box-shadow: 0 18px 55px rgba(2,6,23,.14);}
    .bigBtn:active{transform:scale(.99);}

    .bigBtn .l{display:flex;flex-direction:column;gap:3px}
    .bigBtn .t{font-weight:900;font-size:16px;letter-spacing:.2px}
    .bigBtn .s{font-weight:650;font-size:13px;color: rgba(15,23,42,.60)}
    .bigBtn .arrow{font-weight:900;opacity:.75}

    .bigBtn.primary{
      background: linear-gradient(180deg, rgba(56,189,248,.16), rgba(99,102,241,.10));
      border-color: rgba(56,189,248,.35);
    }
    .bigBtn.disabled{
      opacity:.55;
      pointer-events:none;
      background: linear-gradient(180deg, rgba(15,23,42,.04), rgba(15,23,42,.02));
    }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:900;
      border:1px solid rgba(15,23,42,.10);
      background:#fff;
      color: rgba(15,23,42,.72);
      width: fit-content;
      margin-top:6px;
    }

    /* Botones chicos */
    .smallActions{
      margin-top:12px;
      display:flex;
      justify-content:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .miniBtn{
      border:1px solid rgba(15,23,42,.10);
      background:#fff;
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      font-size:13px;
      text-decoration:none;
      color:var(--txt);
      transition: transform .12s ease;
    }
    .miniBtn:active{transform:scale(.99)}
    .miniBtn.primary{
      background: linear-gradient(180deg, rgba(2,6,23,.06), rgba(2,6,23,.02));
    }

    /* Reglas */
    .rules{
      margin-top:16px;
      border-radius: 22px;
      border:1px solid rgba(56,189,248,.35);
      background: linear-gradient(180deg, rgba(56,189,248,.10), rgba(99,102,241,.06));
      padding:16px;
      color: rgba(15,23,42,.86);
      font-size:14px;
      line-height:1.55;
      max-width: 860px;
      margin-left:auto;
      margin-right:auto;
      text-align:left;
    }
    .rules h3{
      margin:0;
      font-size:16px;
      font-weight:900;
      text-align:center;
      letter-spacing:.2px;
      text-transform:uppercase;
    }
    .rules .sub{
      margin-top:6px;
      text-align:center;
      font-weight:800;
      color: rgba(15,23,42,.72);
    }
    .rules b{color:rgba(15,23,42,.98)}
    .rules ul{margin:10px 0 0; padding-left:18px}
    .rules li{margin:7px 0}

    .foot{
      margin-top:12px;
      text-align:center;
      font-size:12px;
      color: rgba(255,255,255,.65);
      font-weight:700;
    }

    .toast{
      max-width:860px;
      margin:12px auto 0;
      border-radius:18px;
      border:1px solid rgba(15,23,42,.10);
      background:#fff;
      padding:12px;
      font-weight:850;
      color: rgba(15,23,42,.85);
      display:none;
      text-align:center;
    }
    .toast.show{display:block; animation: pop .22s ease-out;}
    @keyframes pop{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
  </style>
</head>

<body>
  <div class="shell">
    <div class="card">
      <div class="main">
        <div class="hero">
          <img class="wordmark" src="assets/logo.svg" alt="aquiservicio.com">

          <div class="municipalityBox">
            <label for="city">MUNICIPIO</label>
            <select id="city">
              <option value="Navolato" selected>Navolato (Disponible)</option>
            </select>
          </div>

          <!-- ‚úÖ Animaci√≥n ahora es BIENVENIDOS -->
          <div class="welcomePill" id="welcomePill"> BIENVENIDOS </div>

          <!-- ‚úÖ T√≠tulo grande debajo -->
          <p class="subtitle">
            Elige lo que necesitas: <b>Comida</b>, <b>Servicios</b> o <b>Marketplace</b>.
          </p>
        </div>

        <div class="btnGrid">
          <a class="bigBtn primary" href="comida.html" id="btnFood">
            <div class="l">
              <div class="t">üçî Comida</div>
              <div class="s">Lo m√°s buscado y verificado</div>
            </div>
            <div class="arrow">‚Üí</div>
          </a>

          <a class="bigBtn primary" href="servicios.html" id="btnServices">
            <div class="l">
              <div class="t">üîß Servicios</div>
              <div class="s">Plomer√≠a, mec√°nico, taxis‚Ä¶</div>
            </div>
            <div class="arrow">‚Üí</div>
          </a>

          <a class="bigBtn disabled" href="marketplace.html" aria-disabled="true">
            <div class="l">
              <div class="t">üõí Marketplace</div>
              <div class="s">Pr√≥ximamente</div>
              <div class="tag">En proceso</div>
            </div>
            <div class="arrow">‚Üí</div>
          </a>
        </div>

        <div class="smallActions">
          <a class="miniBtn primary" href="registrar.html">‚ûï Registrar mi negocio</a>
          <a class="miniBtn" href="login.html" style="opacity:.7;pointer-events:none;">üîê Iniciar sesi√≥n (pr√≥ximamente)</a>
          <a class="miniBtn" href="no-encontre.html">üí° Sugerencias</a>
        </div>

        <div class="rules">
          <h3>REGLAS</h3>
          <div class="sub">(para mantener la calidad)</div>
          <ul>
            <li><b>Publicaci√≥n sujeta a revisi√≥n</b>: se publica solo si cumple reglas.</li>
            <li><b>Pago al recibir</b> (si aplica): al entregar o al recoger, seg√∫n el negocio.</li>
            <li><b>Datos reales</b>: WhatsApp/tel√©fono v√°lidos y nombre claro.</li>
            <li><b>No enga√±os</b>, <b>no suplantaci√≥n</b>, <b>no contenido ofensivo</b>.</li>
            <li><b>Horarios honestos</b>: si son falsos o repetidamente fallan, se baja el perfil.</li>
            <li><b>Reclamar negocio</b> requiere comprobaci√≥n.</li>
            <li><b>Marketplace</b> est√° <b>en proceso</b>: a√∫n no disponible.</li>
          </ul>
        </div>

        <div class="toast" id="toast"></div>
      </div>
    </div>

    <div class="foot">Aquiservicio ‚Ä¢ Hecho para Sinaloa</div>
  </div>

  <!-- Supabase JS v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    // =========================
    // CONFIG (pega tus datos)
    // =========================
    const SUPABASE_URL = "https://rqsyexfjszecqoedojdb.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_7tEQH3atdOIWkWCpK49qKw_B8rSILgT";

    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const citySelect = document.getElementById("city");
    const toast = document.getElementById("toast");

    // Fallback (por si Supabase falla, no se queda en "cargando")
    const FALLBACK_MUNICIPIOS = [
      {name:"Navolato", sort_order:1, active:true},
      {name:"Culiac√°n", sort_order:2, active:false},
      {name:"Mazatl√°n", sort_order:3, active:false},
      {name:"Ahome", sort_order:4, active:false},
      {name:"Guasave", sort_order:5, active:false},
      {name:"Angostura", sort_order:6, active:false},
      {name:"El Fuerte", sort_order:7, active:false},
      {name:"Mocorito", sort_order:8, active:false},
      {name:"Sinaloa", sort_order:9, active:false},
      {name:"Badiraguato", sort_order:10, active:false},
      {name:"Cosal√°", sort_order:11, active:false},
      {name:"Elota", sort_order:12, active:false},
      {name:"Escuinapa", sort_order:13, active:false},
      {name:"Rosario", sort_order:14, active:false},
      {name:"San Ignacio", sort_order:15, active:false},
      {name:"Salvador Alvarado", sort_order:16, active:false},
      {name:"Concordia", sort_order:17, active:false},
      {name:"Choix", sort_order:18, active:false},
      {name:"Juan Jos√© R√≠os", sort_order:19, active:false},
      {name:"Eldorado", sort_order:20, active:false}
    ];

    function showToast(msg){
      toast.textContent = msg;
      toast.className = "toast show";
      setTimeout(()=> toast.className = "toast", 3600);
    }

    function fillMunicipios(list){
      const data = [...list].sort((a,b)=> (a.sort_order||999) - (b.sort_order||999));
      citySelect.innerHTML = "";
      data.forEach(m => {
        const opt = document.createElement("option");
        opt.value = m.name;
        opt.textContent = m.active ? `${m.name} (Disponible)` : `${m.name} (Pr√≥ximamente)`;
        opt.disabled = !m.active;
        citySelect.appendChild(opt);
      });

      // default/persist
      const saved = localStorage.getItem("aq_city");
      const savedOpt = saved ? [...citySelect.options].find(o => o.value === saved) : null;

      if(savedOpt && !savedOpt.disabled){
        citySelect.value = saved;
      }else{
        citySelect.value = "Navolato";
      }
      localStorage.setItem("aq_city", citySelect.value);

      citySelect.onchange = () => {
        const opt = citySelect.options[citySelect.selectedIndex];
        if(opt.disabled){
          citySelect.value = "Navolato";
          showToast("Ese municipio estar√° disponible pr√≥ximamente üôÇ");
          return;
        }
        localStorage.setItem("aq_city", citySelect.value);
      };
    }

    async function loadMunicipios(){
      // Pinta algo √∫til desde el inicio (para que no se quede ‚Äúcargando‚Äù)
      fillMunicipios(FALLBACK_MUNICIPIOS);

      // Intentar Supabase
      try{
        const { data, error } = await sb
          .from("municipios")
          .select("name, active, sort_order")
          .order("sort_order", { ascending: true });

        if(error){
          console.log("Supabase municipios error:", error);
          showToast("No se pudo cargar municipios (usando lista local).");
          return;
        }
        if(!data || data.length === 0){
          showToast("Municipios vac√≠o (usando lista local).");
          return;
        }

        fillMunicipios(data);
      }catch(err){
        console.log("Supabase municipios catch:", err);
        showToast("Sin conexi√≥n a Supabase (usando lista local).");
      }
    }

    loadMunicipios();
  </script>
</body>
</html>
