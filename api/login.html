<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Iniciar sesión • Aquiservicio</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --navy:#0b1220; --navy2:#0f1a33;
      --txt:#0f172a; --mut:#64748b;
      --card:rgba(255,255,255,.94);
      --glow:rgba(56,189,248,.22);
      --shadow:0 20px 70px rgba(2,6,23,.18);
      --r:20px;
      --ok:rgba(34,197,94,.12); --okbd:rgba(34,197,94,.30);
      --err:rgba(239,68,68,.12); --errbd:rgba(239,68,68,.30);
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;color:var(--txt);
      background:
        radial-gradient(900px 600px at 10% 0%, rgba(56,189,248,.14), transparent 60%),
        radial-gradient(900px 600px at 90% 10%, rgba(99,102,241,.12), transparent 55%),
        linear-gradient(180deg, var(--navy), var(--navy2));
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:18px;
    }
    .shell{width:min(520px,100%)}
    .card{
      background:var(--card);border:1px solid rgba(255,255,255,.18);box-shadow:var(--shadow);
      border-radius: calc(var(--r) + 10px);overflow:hidden;backdrop-filter: blur(10px);
      animation: in .35s ease-out;
    }
    @keyframes in{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .main{padding:16px 14px 18px}
    .top{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .back{
      text-decoration:none;font-weight:900;border:1px solid rgba(15,23,42,.10);
      background:#fff;padding:10px 12px;border-radius:999px;color:var(--txt);
    }
    .h{
      margin:10px 0 4px;font-weight:900;font-size:20px;
      background: linear-gradient(90deg, rgba(56,189,248,.9), rgba(99,102,241,.9));
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .p{margin:0;color:rgba(15,23,42,.70);font-weight:750;font-size:13px;line-height:1.45}
    label{display:block;margin-top:12px;font-size:12px;font-weight:900;color:rgba(15,23,42,.70);text-transform:uppercase}
    input{
      width:100%;border-radius:16px;padding:12px 12px;border:1px solid rgba(15,23,42,.14);
      background:#fff;font-weight:850;font-size:14px;outline:none;margin-top:6px;
    }
    input:focus{box-shadow:0 0 0 4px var(--glow);border-color: rgba(56,189,248,.35);}
    .btn{
      margin-top:14px;width:100%;
      border:1px solid rgba(56,189,248,.35);
      background: linear-gradient(180deg, rgba(56,189,248,.18), rgba(99,102,241,.12));
      border-radius:999px;padding:12px 14px;font-weight:900;font-size:14px;cursor:pointer;
    }
    .msg{
      display:none;margin-top:12px;border-radius:18px;padding:12px;font-weight:900;font-size:13px;text-align:center;
      border:1px solid rgba(15,23,42,.12);background: rgba(2,6,23,.03);
    }
    .msg.ok{background:var(--ok);border-color:var(--okbd)}
    .msg.err{background:var(--err);border-color:var(--errbd)}
  </style>
</head>
<body>
  <div class="shell">
    <div class="card">
      <div class="main">
        <div class="top">
          <a class="back" href="index.html">← Inicio</a>
          <img src="assets/logo.svg" alt="aquiservicio.com" style="height:26px;transform:translateX(-6px)">
          <div style="width:60px"></div>
        </div>

        <h1 class="h">Iniciar sesión</h1>
        <p class="p">Solo para negocios aprobados. Si no tienes usuario, regístrate primero.</p>

        <form id="f">
          <label for="u">Usuario</label>
          <input id="u" autocomplete="username" required placeholder="ej: tacosjuan" />

          <label for="pw">Contraseña</label>
          <input id="pw" type="password" autocomplete="current-password" required placeholder="••••••••••" />

          <button class="btn" id="b" type="submit">Entrar</button>
          <div class="msg" id="msg"></div>
        </form>
      </div>
    </div>
  </div>

  <script>
    const $ = (id)=>document.getElementById(id);
    function show(text, ok=true){
      const m = $("msg");
      m.style.display="block";
      m.className="msg " + (ok?"ok":"err");
      m.textContent=text;
    }

    $("f").addEventListener("submit", async (e)=>{
      e.preventDefault();
      $("b").disabled = true;
      $("b").textContent = "Entrando…";

      try{
        const r = await fetch("/api/login", {
          method:"POST",
          headers:{ "content-type":"application/json" },
          body: JSON.stringify({ username: $("u").value, password: $("pw").value })
        });
        const out = await r.json().catch(()=>({}));
        if(!r.ok || out.error) return show("Error: " + (out.error || ("HTTP " + r.status)), false);

        show("Listo ✅", true);
        location.href = "/panel.html";
      }catch(e){
        show("Error: " + (e.message || "No se pudo iniciar"), false);
      }finally{
        $("b").disabled = false;
        $("b").textContent = "Entrar";
      }
    });
  </script>
</body>
</html>
